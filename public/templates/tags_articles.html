{% include "includes/header.html" %}
{% include "includes/articles_styles.html" %}
<!-- æ ‡ç­¾æœç´¢è¡¨å• -->
{% if tag %}
<div class="search-form">
    <form method="GET" action="/views/tag/{{tag.id}}">
        <div class="search-row">
            <div class="form-group">
                <label for="keyword">å…³é”®è¯æœç´¢</label>
                <input type="text" id="keyword" name="keyword" class="form-control" value="{{keyword or ''}}" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜...">
            </div>
        </div>
        
        <div class="search-buttons">
            <button type="submit" class="btn">ğŸ” æœç´¢</button>
            {% if keyword %}
            <a href="/views/tag/{{tag.id}}" class="btn btn-secondary">ğŸ”„ æ¸…é™¤ç­›é€‰</a>
            {% endif %}
        </div>
    </form>
</div>
{% endif %}
<!-- å…¬ä¼—å·ä¿¡æ¯ -->
{% if info %}
<div class="mp-info">
    <div style="width: 48px; height: 48px; background: #e9ecef; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
        {% if info.mp_cover %}
            <img src="{{info.mp_cover}}" alt="{{info.mp_name}}" width="50px"/>
        {% endif %}
    </div>
    <div style="flex: 1;">
        <div style="font-weight: 500; font-size: 1.1rem;">{{info.mp_name}}</div>
        {% if info.mp_intro %}
        <div class="text-muted" style="font-size: 0.9rem;">{{info.mp_intro}}</div>
        {% endif %}
    </div>
</div>
{%endif%}
{% include "includes/tag_style.html" %}

<!-- æ ‡ç­¾ä¿¡æ¯å¤´éƒ¨ -->
<div class="card">
    <div class="tag-header">
        {% if tag.cover %}
        <img src="{{tag.cover}}" alt="{{tag.name}}" class="tag-cover">
        {% else %}
        <div class="tag-cover" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">ğŸ“š</div>
        {% endif %}
        <div class="tag-info">
            <h1>{{tag.name}}</h1>
            <p class="text-muted">{{tag.intro or "æš‚æ— ç®€ä»‹"}}</p>
            <div class="tag-stats">
                <span class="stat-item">ğŸ“º {{tag.mp_count}} ä¸ªå…¬ä¼—å·</span>
                <span class="stat-item">ğŸ“„ {{tag.article_count}} ç¯‡æ–‡ç« </span>
            </div>
        </div>
    </div>
</div>

{% if articles %}
<div class="card">
    {% for article in articles %}
    <div class="article-item">
        <h3><a href="/views/article/{{article.id}}" style="color: inherit; text-decoration: none;">{{article.title}}</a></h3>
        {% if article.description %}
        <p class="text-muted" style="font-size: 0.9rem; margin: 0.5rem 0;text-indent: 2rem;">
            {{article.description}}
        </p>
        {% endif %}
        <div class="article-meta">
            <a href="/views/articles?mp_id={{article.mp_id}}">
            <span>
                <img src="{{article.mp_cover}}" style="width: 20px; height: 20px; border-radius: 50%; margin-right: 0.5rem;"/>
                 {{article.mp_name}}
            </span>
            </a>
            <span>ğŸ• {{article.publish_time}}</span>
            {% if article.is_read %}
            <span style="color: #28a745;">âœ“ å·²è¯»</span>
            {% else %}
            <span style="color: #6c757d;">â—¯ æœªè¯»</span>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>


{% set item_name = "ç¯‡æ–‡ç« " %}
{% include "includes/pagination.html" with context %}

{% include "includes/footer.html" %}