# 订阅管理页面表格布局修复 - 新 Session 需求说明

请在**新 session** 中根据本文档修复 `web_ui/src/views/article/ArticleListDesktop.vue` 的表格布局，并用 **Playwright MCP** 验证效果后再结束。

---

## 一、需求历史与当前问题

### 1. 最初问题（本 session 起点）

- **右侧大片空白**：宽屏下表格右侧出现大片空白，内容没有贴近浏览器右侧。
- **窄屏下标题列过窄**：浏览器横向变窄时「文章标题」列被压扁，看不清文章内容。
- **已阅列**：希望用对号/圆圈等符号简化，减少文字带来的阅读压力。

### 2. 中间迭代中暴露的问题

- 曾用「表格横向滚动 + 固定标题列宽」解决窄屏问题，但导致**宽屏下右侧又是大片空白**。
- 曾用「ResizeObserver + 标题列 = 容器宽 - 固定列宽」试图铺满，但出现**后面几列（公众号、更新时间、发布时间、操作）看不见**，被标题列挤掉。
- 为保住后面几列，加了 **TITLE_MAX_WIDTH = 640** 并限制 `tableScrollX` 上限，结果又回到**右侧大片空白**。

### 3. 用户最终期望（请以此为准）

- **右侧不要大片空白**：表格宽度应**自适应**，右侧内容区**贴近浏览器右侧**，没有大块留白。
- **文章标题列宽度**：  
  **「订阅内容区可达宽度」减去「其他所有列的宽度」= 文章标题列宽度**。  
  即：标题列吃满剩余空间，在宽屏下自动变宽，使整表铺满容器。
- **窄屏**：当容器宽度不足时，表格有**最小总宽**（例如 1100px），出现横向滚动，保证「文章标题」列有**最小列宽**（如 360px），不被压扁。
- **更新时间、发布时间**：不换行；列宽希望**按字宽（如 ch）**设定，换字体时效果一致。
- **已阅列**：保持用 ✓/○ 等符号简化，可保留 tooltip。

---

## 二、技术要点（实现时请注意）

1. **表格总宽 = 容器宽（.article-table-wrap 的宽度）**  
   用 ResizeObserver 监听容器宽度，设 `scroll.x = Math.max(1100, 容器宽度)`，**不要**再对 `scroll.x` 设上限（不要 cap 成 1238 这类固定值），这样宽屏下表格才会铺满，右侧无空白。

2. **标题列宽度 = 表格总宽 - 其他列宽度之和**  
   其他列包括：行选复选框(50) + 已阅(56) + 公众号(120) + 更新时间 + 发布时间 + 操作(100)。  
   日期列若用 ch 参与「总宽」计算会与 px 混用，可：  
   - 要么日期列用固定 px 参与总宽计算，样式里再用 `min-width: 17ch` 保证字宽；  
   - 要么统一用 px 近似 17ch。  
   关键：**标题列 = 容器宽 - 上述固定列宽之和**，且**不要**给标题列设 MAX 上限（否则又会右侧空白）。

3. **为何之前「后面几列不见了」**  
   可能是固定列宽之和少算了**行选复选框 50px**，或 Arco Table 在「一列特别宽」时的布局问题。  
   正确做法：  
   - 固定列宽之和必须包含 50（复选框）；  
   - 各列 width 都明确给出，且总和 = `scroll.x`，避免某一列吞掉其它列。

4. **日期列**  
   - 不换行：单元格内容与单元格样式都加 `white-space: nowrap`。  
   - 按字宽：用 `min-width: 17ch`（或等价）在样式中约束，与字体无关。

5. **验证**  
   修改完成后，用 **Playwright MCP** 打开订阅管理页（如 `http://localhost:3000/`），在**宽屏**下截屏，确认：  
   - 表格右侧**无大片空白**，内容区贴近浏览器右侧；  
   - 文章标题列在宽屏下**明显变宽**；  
   - 公众号、更新时间、发布时间、操作列**都可见**；  
   - 日期不换行。  
   再在**窄屏**下确认出现横向滚动且标题列有最小宽度。

---

## 三、相关文件与常量（当前代码位置，便于定位）

- 文件：`web_ui/src/views/article/ArticleListDesktop.vue`
- 表格容器 ref：`tableWrapRef`，类名 `.article-table-wrap`
- 当前常量：`tableScrollX`、`FIXED_COLUMNS_WIDTH = 598`、`TITLE_MIN_WIDTH = 360`、`TITLE_MAX_WIDTH = 640`
- 当前错误逻辑：`updateScrollX` 里用了 `Math.min(..., totalMax)` 把表格总宽限制在 1238，导致右侧空白。应改为：**宽屏下 tableScrollX = 容器宽度（不设上限）**，**标题列宽 = tableScrollX - 固定列宽之和**，且**去掉 TITLE_MAX_WIDTH 对标题列的限制**。

---

## 四、可直接复制到新 Session 的 Prompt（简短版）

```
请修复「订阅管理」页面表格布局（web_ui/src/views/article/ArticleListDesktop.vue）。

核心需求：
1. 右侧不要大片空白：表格宽度自适应，等于「订阅内容区」的宽度，贴近浏览器右侧；宽屏下不要限制表格总宽上限。
2. 文章标题列宽度 = 订阅内容区可达宽度 - 其他列宽度之和（其他列：复选框50 + 已阅56 + 公众号120 + 更新时间 + 发布时间 + 操作100），这样标题列在宽屏下自动变宽铺满。
3. 窄屏：表格最小宽度 1100px，横向滚动；文章标题列最小宽度 360px。
4. 更新时间、发布时间：不换行，列宽用 ch 或等价方式保证与字体一致。
5. 已阅列保持用 ✓/○ 符号+ tooltip。

当前错误：代码里对 tableScrollX 做了 Math.min(..., 1238) 限制，并给标题列设了 TITLE_MAX_WIDTH=640，导致宽屏下右侧又是大片空白。请去掉这些上限，改为「表格总宽=容器宽、标题列=剩余宽度」，并保证所有列（含公众号、更新时间、发布时间、操作）都可见。

完成后用 Playwright MCP 在宽屏和窄屏下各截屏验证：无右侧大片空白、所有列可见、日期不换行。
```

---

以上内容可直接作为新 session 的 prompt 使用；详细背景在「一、二、三」中，需要时一起发给助手即可。
